<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>İçişleri Bakanlığı | Giriş Sayfası</title>
    <link
      rel="icon"
      type="image/x-icon"
      href="../PNG/icisleri_yuvarlak.png"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css"
      integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="../CSS Pages/login.css" />
    <script src="script.js" defer></script>
  </head>
  <body>
    <div class="main-container">
      <div class="container">
        <button href="#" class="btn btn-login btn-colored" id="login">
          Giriş
        </button>
        <button href="#" class="btn btn-register" id="register">Kayıt Ol</button>
      </div>
      <div class="form-page">
        <button class="sound-btn" id="soundBtn">
          <i class="fa-solid fa-bullhorn"></i>
        </button>

        <div class="login-form">
          <h3>Giriş</h3>
          <div id="warningBox" class="warning active minitext">
            <p id="warningText">Giriş Başarısız</p>
          </div>

          <form action="">
            <input type="email" id="loginEmail" placeholder="Email" />
            <div class="form-group">
              <input type="password" id="password" placeholder="Password" />
              <span>
                <button type="button" id="eye-icon">
                  <i id="eyeOpen" class="fa-solid fa-eye"></i>
                  <i
                    id="eyeClose"
                    class="fa-solid fa-eye-slash active"
                  ></i></button
              ></span>
            </div>
            <div class="remember-me">
              <input type="checkbox" class="checkbox" id="checkbox" />
              <p>Beni Hatırla</p>
            </div>
          </form>
          <button
            type="submit"
            id="loginSubmit"
            class="btn btn-login btn-colored"
          >
            Login
          </button>
          <p class="minitext" style="color: #fff">
            Hesap Oluşturun
            <a
              id="signupText"
              style="text-decoration: underline"
              href="#"
              onclick="return false;"
              >Kayıt Ol</a
            >
          </p>
        </div>
        <div class="register-form active">
          <h3>Kayıt Ol</h3>
          <div id="warningBoxRegister" class="warning active minitext">
            <p id="warningTextRegister">Kayıt Başarısız :</p>
          </div>
          <form action="">
            <input type="text" id="registerUsername" placeholder="Username" />
            <input type="email" id="registerEmail" placeholder="Email" />
            <div class="form-group">
              <input type="password" id="password2" placeholder="Password" />
              <span>
                <button type="button" id="eye-icon-2">
                  <i id="secondeyeOpen" class="fa-solid fa-eye"></i>
                  <i
                    id="secondeyeClose"
                    class="fa-solid fa-eye-slash active"
                  ></i></button
              ></span>
            </div>
            <div class="form-group">
              <input
                type="password"
                id="password-3"
                placeholder="Confirm Password"
              />
              <span>
                <button type="button" id="eye-icon-3">
                  <i id="thirdeyeOpen" class="fa-solid fa-eye"></i>
                  <i
                    id="thirdeyeClose"
                    class="fa-solid fa-eye-slash active"
                  ></i></button
              ></span>
            </div>
          </form>
          <button id="registerSubmit" class="btn btn-register btn-colored">
            Kayıt Ol
          </button>
          <p class="minitext" style="color: #fff">
            Zaten Hesabınız Var mı?
            <a
              style="text-decoration: underline"
              id="loginText"
              href=""
              onclick="return false;"
              >Giriş</a
            >
          </p>
        </div>
      </div>
    </div>
    <script>
        const login = document.getElementById("login");
const register = document.getElementById("register");
const loginForm = document.querySelector(".login-form");
const registerForm = document.querySelector(".register-form");
const loginSubmit = document.getElementById("loginSubmit");
const registerSubmit = document.getElementById("registerSubmit");
const signupText = document.getElementById("signupText");
const loginText = document.getElementById("loginText");




signupText.addEventListener("click", () => {
  registerForm.classList.remove("active");
  register.classList.add("btn-colored");
  login.classList.remove("btn-colored");
  loginForm.classList.add("active");
});

loginText.addEventListener("click", () => {
  registerForm.classList.add("active");
  login.classList.add("btn-colored");
  register.classList.remove("btn-colored");
  loginForm.classList.remove("active");
});

login.addEventListener("click", () => {
  document.title = "Satuhaz | Login Page";
  registerForm.classList.add("active");
  login.classList.add("btn-colored");
  register.classList.remove("btn-colored");
  loginForm.classList.remove("active");

});

register.addEventListener("click", () => {

  document.title = "İçişleri Bakanlığı | Kayıt Sayfası ";
  registerForm.classList.remove("active");
  register.classList.add("btn-colored");
  login.classList.remove("btn-colored");
  loginForm.classList.add("active");
});

// Show / Hide Password

const eyeIcon = document.getElementById("eye-icon");
const secondEyeIcon = document.getElementById("eye-icon-2");
const thirdEyeIcon = document.getElementById("eye-icon-3");
const eyeOpen = document.getElementById("eyeOpen");
const secondeyeOpen = document.getElementById("secondeyeOpen");
const thirdeyeOpen = document.getElementById("thirdeyeOpen");
const eyeClose = document.getElementById("eyeClose");
const secondeyeClose = document.getElementById("secondeyeClose");
const thirdeyeClose = document.getElementById("thirdeyeClose");
const password = document.getElementById("password");
const secondPassword = document.getElementById("password2");
const thirdPassword = document.getElementById("password-3");
const passwordConfirm = document.getElementById("password-confirm");

eyeIcon.addEventListener("click", () => {
  const show =
    password.getAttribute("type") === "password" ? "text" : "password";
  password.setAttribute("type", show);

  if (eyeOpen.classList.contains("active")) {
    eyeOpen.classList.remove("active");
    eyeClose.classList.add("active");
  } else {
    eyeOpen.classList.add("active");
    eyeClose.classList.remove("active");
  }
});

secondEyeIcon.addEventListener("click", () => {
  const show =
    secondPassword.getAttribute("type") === "password" ? "text" : "password";
  secondPassword.setAttribute("type", show);

  if (secondeyeOpen.classList.contains("active")) {
    secondeyeOpen.classList.remove("active");
    secondeyeClose.classList.add("active");
  } else {
    secondeyeOpen.classList.add("active");
    secondeyeClose.classList.remove("active");
  }
});

thirdEyeIcon.addEventListener("click", () => {
  const show =
    thirdPassword.getAttribute("type") === "password" ? "text" : "password";
  thirdPassword.setAttribute("type", show);

  if (thirdeyeOpen.classList.contains("active")) {
    thirdeyeOpen.classList.remove("active");
    thirdeyeClose.classList.add("active");
  } else {
    thirdeyeOpen.classList.add("active");
    thirdeyeClose.classList.remove("active");
  }
});

// Local Storage
const loginPassword = document.getElementById("password");
const loginEmail = document.getElementById("loginEmail");
const registerEmail = document.getElementById("registerEmail");
const registerUsername = document.getElementById("registerUsername");
const checkbox = document.getElementById("checkbox");

loginSubmit.addEventListener("click", () => {
  const loginPassword = document.getElementById("password");
  const loginEmail = document.getElementById("loginEmail");
  const loginObject = {
    email: loginEmail.value || "",
    password: loginPassword.value || "",
    rememberMe: true,
  };

  if (validateLoginForm(loginObject)) {
    if (checkbox.checked) {
      localStorage.setItem("loginForm", JSON.stringify(loginObject));
    } else {
      localStorage.removeItem("loginForm");
    }
  }
});

registerSubmit.addEventListener("click", () => {
  const registerPassword = document.getElementById("password2");
  const registerConfirmPassword = document.getElementById("password-3");
  const registerUsername = document.getElementById("registerUsername");
  const registerEmail = document.getElementById("registerEmail");
  const registerObject = {
    username: registerUsername.value || "",
    email: registerEmail.value || "",
    password: registerPassword.value || "",
    passwordConfirm: registerConfirmPassword.value || "",
  };

  if (validateRegisterForm(registerObject)) {
    localStorage.setItem("registerForm", JSON.stringify(registerObject));
  }
});

const getFromLocalStorage = () => {
  const loginObject = JSON.parse(localStorage.getItem("loginForm"));
  loginEmail.value = isNull("email", loginObject);
  loginPassword.value = isNull("password", loginObject);
  checkbox.checked = isNull("rememberMe", loginObject);

  const registerObject = JSON.parse(localStorage.getItem("registerForm"));
  registerEmail.value = isNull("email", registerObject);
  registerUsername.value = isNull("username", registerObject);
  secondPassword.value = isNull("password", registerObject);
};
getFromLocalStorage();

function isNull(data, obj) {
  return obj ? obj[data] : "";
}

//Form Validation

const warningBox = document.getElementById("warningBox");
const warningText = document.getElementById("warningText");
const warningBoxRegister = document.getElementById("warningBoxRegister");
const warningTextRegister = document.getElementById("warningTextRegister");

function validateLoginForm(data) {
  // Bütün (login)inputlar dolu mu ?
  //emailde gerçekten email mi var?
  //password min 8 char ortaya karışık olsun
  const emailValue = data.email.trim();
  const passwordValue = data.password.trim();

  if (emailValue === "") {
    warningText.innerText = "Giriş Başarısız Oldu: E-posta boş olamaz !";
    warningBox.classList.remove("active");
    
  } else if (!isEmail(emailValue)) {
    warningText.innerText = "Giriş Başarısız : Lütfen geçerli bir e-posta girin !";
    warningBox.classList.remove("active");
    
  }

  if (passwordValue === "") {
    warningText.innerText = "Giriş Başarısız Oldu: Şifre boş olamaz !";
    warningBox.classList.remove("active");
  
  } else if (!isPassword(passwordValue)) {
    warningText.innerText = "Giriş Başarısız: Lütfen geçerli bir şifre girin !";
    warningBox.classList.remove("active");
   
  }

  if (!isPassword(passwordValue) && !isEmail(emailValue)) {
    warningText.innerText =
      "Giriş Başarısız : Şifreniz ve e-posta adresiniz geçerli değil !";
    warningBox.classList.remove("active");
   
  }
  if (emailValue === "" && passwordValue === "") {
    warningText.innerText = "Giriş Başarısız : Girişler boş olamaz !";
    warningBox.classList.remove("active");

  }

  if (
    isEmail(emailValue) &&
    isPassword(passwordValue) &&
    emailValue != "" &&
    passwordValue != ""
  ) {
    warningBox.classList.add("active");
   
  }
  return data;
}

function validateRegisterForm(data) {
  const emailValue = data.email.trim();
  const passwordValue = data.password.trim();
  const usernameValue = data.username.trim();
  const passwordConfirmValue = data.passwordConfirm.trim();

  if (usernameValue === "") {
    warningTextRegister.innerText =
      "Kayıt Başarısız : Kullanıcı adı boş bırakılamaz !";
    warningBoxRegister.classList.remove("active");
  
  } else if (usernameValue[3] == null) {
    warningTextRegister.innerText =
      "Kayıt Başarısız : Kullanıcı adı 4 karakterden az olamaz !";
    warningBoxRegister.classList.remove("active");
   
  }

  if (emailValue === "") {
    warningTextRegister.innerText = "Kayıt Başarısız: E-posta boş olamaz !";
    warningBoxRegister.classList.remove("active");
  
  } else if (!isEmail(emailValue)) {
    warningTextRegister.innerText =
      "Kayıt Başarısız : Lütfen geçerli bir e-posta girin !";
    warningBoxRegister.classList.remove("active");

  }

  if (passwordValue === "") {
    warningTextRegister.innerText =
      "Kayıt Başarısız : Şifre boş olamaz !";
    warningBoxRegister.classList.remove("active");

  } else if (!isPassword(passwordValue)) {
    warningTextRegister.innerText =
      "Kayıt Başarısız: Lütfen geçerli bir şifre girin !";
    warningBoxRegister.classList.remove("active");
   
  } else if (passwordValue != passwordConfirmValue) {
    warningTextRegister.innerText =
      "Kayıt Başarısız : Lütfen girişlere aynı şifreyi girin !";
    warningBoxRegister.classList.remove("active");

  }
  if (!isPassword(passwordValue) && !isEmail(emailValue)) {
    warningTextRegister.innerText =
      "Kayıt Başarısız : Şifreniz ve e-posta adresiniz geçerli değil !";
    warningBoxRegister.classList.remove("active");
 
  }
  if (emailValue === "" && passwordValue === "") {
    warningTextRegister.innerText = "Kayıt Başarısız : Girişler boş olamaz !";
    warningBoxRegister.classList.remove("active");
  
  }

  if (
    isEmail(emailValue) &&
    isPassword(passwordValue) &&
    emailValue != "" &&
    passwordValue != "" &&
    passwordValue === passwordConfirmValue &&
    usernameValue != ""
  ) {
    warningBoxRegister.classList.add("active");

  }

  return data;
}

function isEmail(email) {
  return /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(
    email
  );
}

function isPassword(password) {
  return /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/.test(
    password
  );
}

    </script>
  </body>
</html>
